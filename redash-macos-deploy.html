<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link rel="shortcut icon" href="/favicon.ico"> <title>[BIG DATA] Redash 9.0 on macOS 安装部署 - LanKE.e 婪歌</title> <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet"> <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet"> <link rel="stylesheet" href="/assets/dist/css/style.css"> <!-- <link rel="stylesheet" href="/assets/dist/awsm.css/awsm_theme_big-stone.min.css" media="(prefers-color-scheme: dark)"> <link rel="stylesheet" href="/assets/dist/awsm.css/awsm_theme_white.min.css" media="(prefers-color-scheme: no-preference), (prefers-color-scheme: light)"> <link rel="stylesheet" href="/assets/dist/rouge/syntax-base16.dark.css" media="(prefers-color-scheme: dark)"> <link rel="stylesheet" href="/assets/dist/rouge/syntax-github.css" media="(prefers-color-scheme: no-preference), (prefers-color-scheme: light)"> --> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>[BIG DATA] Redash 9.0 on macOS 安装部署 | LanKE.e 婪歌</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="[BIG DATA] Redash 9.0 on macOS 安装部署" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Redash简介" /> <meta property="og:description" content="Redash简介" /> <link rel="canonical" href="https://lankee.blog/redash-macos-deploy.html" /> <meta property="og:url" content="https://lankee.blog/redash-macos-deploy.html" /> <meta property="og:site_name" content="LanKE.e 婪歌" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-05-27T00:00:00+08:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="[BIG DATA] Redash 9.0 on macOS 安装部署" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-05-27T00:00:00+08:00","datePublished":"2020-05-27T00:00:00+08:00","description":"Redash简介","headline":"[BIG DATA] Redash 9.0 on macOS 安装部署","mainEntityOfPage":{"@type":"WebPage","@id":"https://lankee.blog/redash-macos-deploy.html"},"url":"https://lankee.blog/redash-macos-deploy.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="content"> <header> <div class="main"> <a href="https://lankee.blog/">LanKE.e 婪歌</a> </div> <nav> <a class='' href="/">首页</a> <!-- <a class='' href="/archives.html"> Archives</a> --> <a class='' href="/about.html">关于</a> </nav> </header> <hr class="light-hr"> <main> <div class="title"> <h1 class="title">[BIG DATA] Redash 9.0 on macOS 安装部署</h1> <div class="meta"> <time datetime="27-05-2020">May 27 2020</time> </div> </div> <hr class="no-margin light-hr "> <h2 id="redash简介">Redash简介</h2> <p>现在市面上有三大开源数据可视化工具, 分别是 Metebase, Superset 和 Redash. Redash 相对于前两种虽然功能性和可视化图表相对少了一些, 但是也因为操作简单, 用户体验更好, 而且代码的可读性更强, 更易于二次开发, 功能定制.</p> <p>源码地址: <a href="https://github.com/getredash/redash.git" target="_blank">https://github.com/getredash/redash.git</a></p> <p>Redash 架构图:</p> <center> <img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/dist/images/0002.pic.jpg" /> <br /> <!-- <div style="color:orange; border-bottom: 1px solid #d9d9d9;display: inline-block;color: #999;padding: 2px;">图片来自网络, 侵删</div> --> </center> <h2 id="安装部署macos">安装部署(macOS)</h2> <h3 id="docker-一键安装">Docker 一键安装</h3> <p>下载源码后, 切换到项目路径, 分别执行一下命令:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 拉取所有依赖镜像并初始化数据库</span>
docker-compose run –rm server create_db
<span class="c"># 创建容器并运行, -d为后台执行</span>
docker-compose up <span class="nt">-d</span>
</code></pre></div></div> <p>然后访问 http://127.0.0.1:5000 即可进入 Redash</p> <p>如果出现界面样式失效, 可能是因为 node 容器没有创建导致前端资源没有编译, 可以在执行以下命令手动编译:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 下载所有依赖</span>
npm <span class="nb">install</span>
<span class="c"># 编译运行</span>
npm run build
</code></pre></div></div> <p>如果需要自定义配置, 可以修改 docker-compose.yml 中的制定配置项</p> <p>其他命令</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 停止容器</span>
docker-compose stop
<span class="c"># 停止并删除相关容器</span>
docker-compose down
</code></pre></div></div> <h3 id="自助安装">自助安装</h3> <p>安装以下主要组件依赖, macOS 下可用 homebrew 一键安装</p> <ul> <li>python3</li> <li>redis</li> <li>nodejs</li> <li>freetds</li> <li>postgresql</li> </ul> <p>postgresql 的初始化的主要命令:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 初始化</span>
initdb /usr/local/var/postgres
<span class="c"># 根据当前用户创建一个db</span>
created
<span class="c"># 进入postgres cli</span>
psql
<span class="c"># 创建一个用户</span>
CREATE USER postgres WITH PASSWORD <span class="s1">'123456'</span><span class="p">;</span>
<span class="c"># 删除自动生成'postgres'db</span>
DROP DATABASE postgres<span class="p">;</span>
<span class="c"># 创建一个属于新创建用户的db</span>
CREATE DATABASE postgres OWNER postgres<span class="p">;</span>
<span class="c"># 赋予权限</span>
GRANT ALL PRIVILEGES ON DATABASE postgres to postgres<span class="p">;</span>
<span class="c"># 角色</span>
ALTER ROLE postgres CREATEDB<span class="p">;</span>
</code></pre></div></div> <p><strong>修改配置</strong></p> <p>所有配置项基本就在此文件下: <em>redash/settings/__init__.py</em></p> <p>如修改数据库配置 <strong>REDASH_DATABASE_URL</strong> 改为如下内容:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s">"REDASH_DATABASE_URL"</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"DATABASE_URL"</span><span class="p">,</span> <span class="s">"postgresql://postgres:123456@127.0.0.1:5432/postgres"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div> <p><strong>python 相关</strong></p> <p>推荐使用 python 环境运行, 主要命令:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 进入到项目目录下</span>
<span class="c"># 下载虚拟环境模块</span>
pip3 <span class="nb">install </span>virtualenv
<span class="c"># 创建虚拟环境</span>
virtualenv <span class="nt">-p</span> python3 venv
<span class="c"># 运行虚拟环境</span>
<span class="nb">source </span>venv/bin/activate
</code></pre></div></div> <p>所有 python 依赖包拉取:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 安装所有基础依赖和数据库连接依赖</span>
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt <span class="nt">-r</span> requirements_all_ds.txt
</code></pre></div></div> <p>可能出现的问题: 安装 psycopg2 可能会出现: <em><code class="language-plaintext highlighter-rouge">Error: pg_config executable not found.</code></em></p> <p>解决: 把 postgresql 的 bin 目录加入环境变量, 或者不安装 psycopg2 直接安装 psycopy2-binary (requirements.txt 文件中注释掉该行)</p> <p>安装 mysqlclient 可能会出现: <em><code class="language-plaintext highlighter-rouge">Error: mysql_config not found.</code></em></p> <p>解决: 安装 mysql-connector-c 并加入环境变量, 如果已安装过 mysql 相关模块仍报此问题, 可能就是环境变量问题.</p> <p>安装完成后执行:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python manage.py check_settings
</code></pre></div></div> <p>如果没问题的话就会打印出当前所有设置项内容</p> <p><strong>前端编译</strong></p> <p><em>(注意 nodejs 版本不能太低)</em></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install
</span>npm run build
</code></pre></div></div> <p><strong>初始化元数据库</strong></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python manage.py database create_tables
</code></pre></div></div> <p><strong>运行</strong></p> <p>需要运行三个模块: <strong>Web Server</strong> 和 <strong>RQ worker</strong> &amp; <strong>scheduler</strong></p> <p>所以可以开三个终端窗口分别运行:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyhton manage.py runserver –debugger –reload <span class="nt">-h</span> 0.0.0.0 <span class="nt">-p</span> 5000
python manage.py rq worker
python manage.py rq scheduler  <span class="c">##(此调度程序非必须运行)</span>
</code></pre></div></div> <p><strong>Done</strong></p> <p>访问 http://127.0.0.1:5000 注册一个账户开启 Redash 吧</p> <p><br /></p> <div class="post-tags"> <nav class="nav-post-tags-list"> <ul class="tags"> <li><a href="/tag/big-data/">Big Data</a></li> <li><a href="/tag/redash/">Redash</a></li> <li><a href="/tag/dashboard/">Dashboard</a></li> </ul> </nav> </div> </main> <footer> <hr class="footer-hr"> <div class="ui-flex"> <div class='wrapper-footer'> © 2023 LanKE.e 婪歌 | <a href="mailto:dr.xx.yvens@gmail.com">Yven Fong</a> </div> </div> </footer> </div> </body> </html>
